<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      background: linear-gradient(135deg, #f9fafb, #e0e7ff);
      color: #333;
    }

    .container {
      width: 100%;
      max-width: 480px;
      padding: 20px;
    }

    .card {
      background: white;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
      overflow: hidden;
    }

    .card-header {
      padding: 20px;
      background: #2563eb;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .card-title {
      font-size: 1.5rem;
      font-weight: bold;
      margin: 0;
    }

    .language-switch {
      padding: 4px 8px;
      border: none;
      border-radius: 6px;
      background: white;
      color: #2563eb;
      font-weight: 500;
      cursor: pointer;
    }

    .card-content {
      padding: 24px;
    }

    .tabs {
      display: flex;
      border-bottom: 2px solid #eee;
      margin-bottom: 20px;
    }

    .tab {
      flex: 1;
      text-align: center;
      padding: 12px;
      cursor: pointer;
      font-weight: 500;
      color: #666;
      border-bottom: 3px solid transparent;
      transition: all 0.2s ease;
    }

    .tab.active {
      color: #2563eb;
      border-bottom-color: #2563eb;
      font-weight: 600;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .input-group {
      margin-bottom: 20px;
    }

    .input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #444;
    }

    input[type="number"],
    input[type="text"] {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 15px;
    }

    .radio-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 16px;
    }

    .result-card {
      background: #f9fafb;
      border-radius: 12px;
      padding: 16px;
      margin-top: 12px;
      border: 1px solid #e5e7eb;
    }

    .result-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px dashed #ddd;
    }

    .result-row:last-child {
      border-bottom: none;
    }

    .label {
      font-weight: 500;
      color: #555;
    }

    .amount-display {
      text-align: right;
    }

    .primary-amount {
      font-weight: bold;
      font-size: 1.1rem;
    }

    .secondary-amount {
      font-size: 0.85rem;
      color: #666;
    }

    .fee {
      color: #dc2626;
    }

    .final-amount {
      color: #059669;
      font-weight: bold;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <div class="card-header">
        <h1 class="card-title" data-zh="支付平台費用計算器" data-en="Payment Platform Fee Calculator">支付平台費用計算器</h1>
        <select class="language-switch" onchange="switchLanguage(this.value)">
          <option value="zh">中文</option>
          <option value="en">English</option>
        </select>
      </div>
      <div class="card-content">
        <div class="tabs">
          <div class="tab" onclick="switchTab('tebex')">TEBEX</div>
          <div class="tab active" onclick="switchTab('paypal')">PayPal</div>
        </div>

        <!-- PayPal -->
        <div id="paypal-content" class="tab-content active">
          <div class="input-group">
            <label data-zh="交易金額 (TWD):" data-en="Transaction Amount (TWD):">交易金額 (TWD):</label>
            <input type="number" value="303" min="0" step="1" id="amount-twd" oninput="calculatePayPal()">
          </div>

          <div class="radio-group">
            <label>
              <input type="radio" name="transaction-type" checked onchange="calculatePayPal()">
              <span data-zh="跨境交易 (4.4% + 固定費用)" data-en="Cross-border Transaction (4.4% + Fixed Fee)">跨境交易 (4.4% + 固定費用)</span>
            </label>
            <label>
              <input type="radio" name="transaction-type" onchange="calculatePayPal()">
              <span data-zh="本地交易 (2.9% + 固定費用)" data-en="Local Transaction (2.9% + Fixed Fee)">本地交易 (2.9% + 固定費用)</span>
            </label>
          </div>

          <div class="input-group">
            <label data-zh="匯率設定" data-en="Exchange Rate">匯率設定</label>
            <div>
              <span>1 USD = </span>
              <input type="number" value="30.31" step="0.01" min="0" id="exchange-rate" oninput="calculatePayPal()">
              <span>TWD</span>
            </div>
          </div>

          <div id="paypal-results" class="result-card"></div>
        </div>

        <!-- Tebex -->
        <div id="tebex-content" class="tab-content">
          <div class="input-group">
            <label data-zh="原始金額 ($):" data-en="Original Amount ($):">原始金額 ($):</label>
            <input type="number" value="10.00" min="0" step="0.01" id="amount-usd" oninput="calculateTebex()">
          </div>

          <div class="input-group">
            <label>
              <input type="checkbox" id="use-discount" onchange="calculateTebex()">
              <span data-zh="啟用折扣" data-en="Enable Discount">啟用折扣</span>
            </label>
            <div id="discount-input" style="display: none; margin-top: 8px;">
              <input type="number" value="0.9" min="0" max="1" step="0.1" id="discount-rate" oninput="calculateTebex()">
              <span data-zh="折 (例：0.9 = 9折)" data-en="off (e.g., 0.9 = 10% off)">折 (例：0.9 = 9折)</span>
            </div>
          </div>

          <div id="tebex-results" class="result-card"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentLang = 'zh';

    function switchLanguage(lang) {
      currentLang = lang;
      document.querySelectorAll('[data-zh][data-en]').forEach(el => {
        el.textContent = el.getAttribute(`data-${lang}`);
      });
      calculatePayPal();
      calculateTebex();
    }

    function switchTab(tabName) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

      const selectedTab = document.querySelector(`.tab:nth-child(${tabName === 'tebex' ? '1' : '2'})`);
      const selectedContent = document.getElementById(`${tabName}-content`);

      selectedTab.classList.add('active');
      selectedContent.classList.add('active');
    }

    function calculatePayPal() {
      const amountTWD = parseFloat(document.getElementById('amount-twd').value) || 0;
      const exchangeRateInput = parseFloat(document.getElementById('exchange-rate').value) || 30.31;
      const exchangeRate = 1 / exchangeRateInput; // 轉成 1 TWD = ? USD
      const isCrossBorder = document.querySelector('input[name="transaction-type"]').checked;
      const rate = isCrossBorder ? 0.044 : 0.029;
      const fixedFeeTWD = 10;

      const amountUSD = amountTWD * exchangeRate;
      const percentageFeeTWD = amountTWD * rate;
      const percentageFeeUSD = amountUSD * rate;
      const fixedFeeUSD = fixedFeeTWD * exchangeRate;
      const totalFeeTWD = percentageFeeTWD + fixedFeeTWD;
      const totalFeeUSD = percentageFeeUSD + fixedFeeUSD;
      const finalAmountTWD = amountTWD - totalFeeTWD;
      const finalAmountUSD = amountUSD - totalFeeUSD;

      document.getElementById('paypal-results').innerHTML = `
        <div class="result-row">
          <span class="label">${currentLang === 'zh' ? '交易金額' : 'Transaction Amount'}</span>
          <div class="amount-display">
            <div class="primary-amount">NT$${amountTWD.toFixed(0)}</div>
            <div class="secondary-amount">USD $${amountUSD.toFixed(2)}</div>
          </div>
        </div>

        <div class="result-row">
          <span class="label">${currentLang === 'zh' ? '比例費用' : 'Percentage Fee'} (${(rate * 100).toFixed(1)}%)</span>
          <div class="amount-display fee">
            <div class="primary-amount">-NT$${percentageFeeTWD.toFixed(0)}</div>
            <div class="secondary-amount">-USD $${percentageFeeUSD.toFixed(2)}</div>
          </div>
        </div>

        <div class="result-row">
          <span class="label">${currentLang === 'zh' ? '固定費用' : 'Fixed Fee'}</span>
          <div class="amount-display fee">
            <div class="primary-amount">-NT$${fixedFeeTWD.toFixed(0)}</div>
            <div class="secondary-amount">-USD $${fixedFeeUSD.toFixed(2)}</div>
          </div>
        </div>

        <div class="result-row">
          <span class="label">${currentLang === 'zh' ? '總費用' : 'Total Fee'}</span>
          <div class="amount-display fee">
            <div class="primary-amount">-NT$${totalFeeTWD.toFixed(0)}</div>
            <div class="secondary-amount">-USD $${totalFeeUSD.toFixed(2)}</div>
          </div>
        </div>

        <div class="result-row">
          <span class="label final-amount">${currentLang === 'zh' ? '最終收到金額' : 'Final Amount'}</span>
          <div class="amount-display">
            <div class="final-amount">NT$${finalAmountTWD.toFixed(0)}</div>
            <div class="secondary-amount final-amount">USD $${finalAmountUSD.toFixed(2)}</div>
          </div>
        </div>
      `;
    }

    function calculateTebex() {
      const amount = parseFloat(document.getElementById('amount-usd').value) || 0;
      const useDiscount = document.getElementById('use-discount').checked;
      const discountRate = parseFloat(document.getElementById('discount-rate').value) || 0.9;

      document.getElementById('discount-input').style.display = useDiscount ? 'block' : 'none';

      const discountedAmount = useDiscount ? (amount * discountRate) : amount;
      const tebexFee = discountedAmount * 0.10;
      const paypalFee = discountedAmount * 0.029 + 0.30;
      const totalFees = tebexFee + paypalFee;
      const finalAmount = discountedAmount - totalFees;

      document.getElementById('tebex-results').innerHTML = `
        <div class="result-row">
          <span class="label">Tebex 10%</span>
          <div class="amount-display fee">-$${tebexFee.toFixed(2)}</div>
        </div>
        <div class="result-row">
          <span class="label">PayPal 2.9% + $0.30</span>
          <div class="amount-display fee">-$${paypalFee.toFixed(2)}</div>
        </div>
        <div class="result-row">
          <span class="label">${currentLang === 'zh' ? '總費用' : 'Total Fee'}</span>
          <div class="amount-display fee">-$${totalFees.toFixed(2)}</div>
        </div>
        <div class="result-row">
          <span class="label final-amount">${currentLang === 'zh' ? '最終收到金額' : 'Final Amount'}</span>
          <div class="amount-display final-amount">$${finalAmount.toFixed(2)}</div>
        </div>
      `;
    }

    calculatePayPal();
    calculateTebex();
  </script>
</body>
</html>
